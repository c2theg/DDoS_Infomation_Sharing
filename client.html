<!DOCTYPE html><!--[if lt IE 9]><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"><![endif]--><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><meta name="author" content="Copyright (c) 2017 Christopher MJ Gray - Updated  6/13/2017 07:49:06 EST" /><META NAME="application-name" CONTENT="DDoS Information Sharing" /><META NAME="ROBOTS" CONTENT="NO-INDEX, NO-FOLLOW"><meta name="generator" content="By hand!"><meta name="description" content="DDoS Information Sharing"><meta name="keyword" content="ddos"><META NAME="revisit-after" CONTENT="300">
    <link rel="icon" href="https://raw.githubusercontent.com/c2theg/DDoS_Information_Sharing/master/images/favicon.ico">
    <title>DDoS Information Sharing - v0.0.3</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"><link href="https://getbootstrap.com/examples/dashboard/dashboard.css" rel="stylesheet">
    <link href="https://cdn.datatables.net/1.10.15/css/dataTables.bootstrap.min.css" rel="stylesheet">
  </head><body>
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">DDoS Info Sharing - Viewer</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="#">Dashboard</a></li>
            <li><a href="#">Settings</a></li>
            <li><a href="#">Help</a></li>
          </ul>
          <form class="navbar-form navbar-right">
            <input type="text" class="form-control" placeholder="Search...">
          </form>
        </div>
      </div>
    </nav>

    <div class="container-fluid">
      <div class="row">
        <div class="col-sm-3 col-md-2 sidebar">
          <ul class="nav nav-sidebar">
            <li class="active"><a href="#">Overview <span class="sr-only">(current)</span></a></li>
          </ul>
        </div>
        <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
          <h1 class="page-header">Dashboard  <button class="btn btn-default" id="btn_refresh" name="btn_refresh" type="button"><span class="glyphicon glyphicon-refresh" aria-hidden="true"></span></button> <span id="lbl_status_main"></span></h1>
          <span id="lbl_status_minor"></span>

          <h2 class="sub-header">Attacking Source IP's</h2>
          <div class="table-responsive">
            <table id="tbl_sources" class="table table-striped table-bordered table-hover table-condensed" cellspacing="0" width="100%">
              <thead>
                <tr>
                  <th>IP Address</th>
                  <th>Location</th>
                  <th>Speed</th>
                  <th>Reported By</th>
                  <th>Info</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>1,001</td>
                  <td>Lorem</td>
                  <td>ipsum</td>
                  <td>dolor</td>
                  <td>sit</td>
                </tr>
                <tr>
                  <td>1,002</td>
                  <td>amet</td>
                  <td>consectetur</td>
                  <td>adipiscing</td>
                  <td>elit</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <!-- ================================================== -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.15/js/jquery.dataTables.min.js"></script><script src="https://cdn.datatables.net/1.10.15/js/dataTables.bootstrap.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function() {
            $('#btn_refresh').click(function(e) {
                load_CritsDB();
            });
            
            function load_CritsDB() {
                var data = IS_User = IS_Key = IS_URL = IS_Limit = '';
                IS_User = '';
                IS_Key = '';
                IS_Limit = 30;
                IS_URL = "https://dis-demo2.cablelabs.com/api/v1/ips/";
                if (IS_Key != '') {
                    $('#lbl_status_minor').fadeTo("fast",100).html("<div class='alert alert-info' role='alert'><img src='https://bit.ly/cgray-loader4' alt='loading' /> Gathering Data from: " + IS_URL + "</div>");
                    $.ajax({
                        url: IS_URL,
                        dataType: "text",
                        type: 'GET',
                        data: {
                            username: IS_User,
                            api_key: IS_Key,
                            limit: IS_Limit
                        },
                        success: function(data) {
                            //alert("got back: " + data);
                            $('#lbl_status_minor').fadeTo("fast",100).html("<div class='alert alert-success' role='alert'>Received: " + data + "</div>");
                            if (data != '') {
                                $.each(data.dates, function(index, element) {
                                    //alert(element.timeStamp); 
                                    $('#tbl_sources tr:last').after('<tr>...</tr><tr>...</tr>');
                                });
                                $('#tbl_sources').DataTable(); // instantiate datatable
                            }
                        },
                        parsererror: function(data) {
                            $('#lbl_status_minor').html("<div class='alert alert-info' role='alert'> Ajax load error. Returned: " + data + "</div>");
                        },
                        timeout: function(data) {
                            $('#lbl_status_minor').html("<div class='alert alert-info' role='alert'>Timeout. Returned: " + data + "</div>");
                        },
                        notmodified: function(data) {
                            $('#lbl_status_minor').html("<div class='alert alert-info' role='alert'> <i aria-hidden='true' class='i-warning'></i> Not Modified. Returned: " + data + "</div>");
                        },
                        error: function (xmlHttpRequest, textStatus, errorThrown) {
                            $('#lbl_status_minor').html("<div class='alert alert-danger' role='alert'>AJAX Error - Data Returned: " + data + ", XHR: " + xmlHttpRequest + ", Status: " + textStatus + ", Error: " + errorThrown + " Stringified: " + JSON.stringify(data) + "</div>");
                            //alert("Error AJAX - Data Returned: " + data + ", XHR: " + xmlHttpRequest + ", Status: " + textStatus + ", Error: " + errorThrown + " Stringified: " + JSON.stringify(data));
                        }
                    });  // end of ajax call
                } else {
                    $('#lbl_status_minor').fadeTo("fast",100).html("<div class='alert alert-danger' role='alert'><img src='https://bit.ly/cgray-img-error' alt='error' /> Please edit the code and enter your CRITS Username and Api Key</div>");
               }
            }
            
            load_CritsDB();
            /* --------------------------------------------------------------------------------------------------------- */
            timer(300000,
                    function(timeleft) { // called every step to update the visible countdown
                        //document.getElementById('timer').innerHTML = timeleft+" second(s)";
                    },
                    function() { // what to do after
                        //alert("Timer complete!");
                        load_CritsDB();
                    }
            );
            
            function timer(time,update,complete) {
                var start = new Date().getTime();
                var interval = setInterval(function() {
                    var now = time-(new Date().getTime()-start);
                    if( now <= 0) {
                        clearInterval(interval);
                        complete();
                    }
                    else update(Math.floor(now/1000));
                },100); // the smaller this number, the more accurate the timer will be
            }
           
            
        }); /* --- End jQuery --- */
        /* --------------------------------------------------------------------------------------------------------- */
        function createCookie(name, value, days) {
            var expires;

            if (days) {
                var date = new Date();
                date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
                expires = "; expires=" + date.toGMTString();
            } else {
                expires = "";
            }
            document.cookie = encodeURIComponent(name) + "=" + encodeURIComponent(value) + expires + "; path=/";
        }

        function readCookie(name) {
            var nameEQ = encodeURIComponent(name) + "=";
            var ca = document.cookie.split(';');
            for (var i = 0; i < ca.length; i++) {
                var c = ca[i];
                while (c.charAt(0) === ' ') c = c.substring(1, c.length);
                if (c.indexOf(nameEQ) === 0) return decodeURIComponent(c.substring(nameEQ.length, c.length));
            }
            return null;
        }

        function eraseCookie(name) {
            createCookie(name, "", -1);
        }
    </script>
</body></html>
